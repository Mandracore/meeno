<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>public/javascripts/models/filter.js - Meeno source code documentation</title>
    <link rel="stylesheet" href="http://yui.yahooapis.com/3.9.1/build/cssgrids/cssgrids-min.css">
    <link rel="stylesheet" href="../assets/vendor/prettify/prettify-min.css">
    <link rel="stylesheet" href="../assets/css/main.css" id="site_styles">
    <link rel="icon" href="../assets/favicon.ico">
    <script src="http://yui.yahooapis.com/combo?3.9.1/build/yui/yui-min.js"></script>
</head>
<body class="yui3-skin-sam">

<div id="doc">
    <div id="hd" class="yui3-g header">
        <div class="yui3-u-3-4">
                <h1><img src="../assets/css/logo.png" title="Meeno source code documentation" width="117" height="52"></h1>
        </div>
        <div class="yui3-u-1-4 version">
            <em>API Docs for: 0.2.5</em>
        </div>
    </div>
    <div id="bd" class="yui3-g">

        <div class="yui3-u-1-4">
            <div id="docs-sidebar" class="sidebar apidocs">
                <div id="api-list">
                    <h2 class="off-left">APIs</h2>
                    <div id="api-tabview" class="tabview">
                        <ul class="tabs">
                            <li><a href="#api-classes">Classes</a></li>
                            <li><a href="#api-modules">Modules</a></li>
                        </ul>
                
                        <div id="api-tabview-filter">
                            <input type="search" id="api-filter" placeholder="Type to filter APIs">
                        </div>
                
                        <div id="api-tabview-panel">
                            <ul id="api-classes" class="apis classes">
                                <li><a href="../classes/BrowserBodyFilterView.html">BrowserBodyFilterView</a></li>
                                <li><a href="../classes/BrowserBodyNoteView.html">BrowserBodyNoteView</a></li>
                                <li><a href="../classes/BrowserBodyObjectView.html">BrowserBodyObjectView</a></li>
                                <li><a href="../classes/BrowserBodyTagView.html">BrowserBodyTagView</a></li>
                                <li><a href="../classes/BrowserBodyTaskView.html">BrowserBodyTaskView</a></li>
                                <li><a href="../classes/BrowserBodyView.html">BrowserBodyView</a></li>
                                <li><a href="../classes/BrowserTabView.html">BrowserTabView</a></li>
                                <li><a href="../classes/BrowserView.html">BrowserView</a></li>
                                <li><a href="../classes/EditorBodyView.html">EditorBodyView</a></li>
                                <li><a href="../classes/EditorTabView.html">EditorTabView</a></li>
                                <li><a href="../classes/EditorView.html">EditorView</a></li>
                                <li><a href="../classes/MainView.html">MainView</a></li>
                                <li><a href="../classes/Note.html">Note</a></li>
                                <li><a href="../classes/NoteFilter.html">NoteFilter</a></li>
                                <li><a href="../classes/NoteFilters.html">NoteFilters</a></li>
                                <li><a href="../classes/Notes.html">Notes</a></li>
                                <li><a href="../classes/NoteTag.html">NoteTag</a></li>
                                <li><a href="../classes/NoteTask.html">NoteTask</a></li>
                                <li><a href="../classes/ObjectFilter.html">ObjectFilter</a></li>
                                <li><a href="../classes/ObjectFilters.html">ObjectFilters</a></li>
                                <li><a href="../classes/TagFilter.html">TagFilter</a></li>
                                <li><a href="../classes/TagFilters.html">TagFilters</a></li>
                                <li><a href="../classes/Tags.html">Tags</a></li>
                                <li><a href="../classes/Task.html">Task</a></li>
                                <li><a href="../classes/TaskFilter.html">TaskFilter</a></li>
                                <li><a href="../classes/TaskFilters.html">TaskFilters</a></li>
                                <li><a href="../classes/Tasks.html">Tasks</a></li>
                                <li><a href="../classes/TaskTag.html">TaskTag</a></li>
                            </ul>
                
                            <ul id="api-modules" class="apis modules">
                                <li><a href="../modules/App.html">App</a></li>
                                <li><a href="../modules/temp.html">temp</a></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="yui3-u-3-4">
                <div id="api-options">
                    Show:
                    <label for="api-show-inherited">
                        <input type="checkbox" id="api-show-inherited" checked>
                        Inherited
                    </label>
            
                    <label for="api-show-protected">
                        <input type="checkbox" id="api-show-protected">
                        Protected
                    </label>
            
                    <label for="api-show-private">
                        <input type="checkbox" id="api-show-private">
                        Private
                    </label>
                    <label for="api-show-deprecated">
                        <input type="checkbox" id="api-show-deprecated">
                        Deprecated
                    </label>
            
                </div>
            
            <div class="apidocs">
                <div id="docs-main">
                    <div class="content">
<h1 class="file-heading">File: public/javascripts/models/filter.js</h1>

<div class="file">
    <pre class="code prettyprint linenums">
define ([
	// path aliases preconfigured in ../main.js
		&#x27;jquery&#x27;,
		&#x27;underscore&#x27;,
		&#x27;backbone&#x27;,
		&#x27;models/task&#x27;,
		&#x27;models/tag&#x27;,
	], function ($, _, Backbone, Task, Tag) {

		/**
		 * Parent of the classes {{#crossLink &quot;NoteFilter&quot;}}{{/crossLink}}, {{#crossLink &quot;TaskFilter&quot;}}{{/crossLink}} and {{#crossLink &quot;TagFilter&quot;}}{{/crossLink}}.
		 * It holds all the common methods.
		 * 
		 * @class ObjectFilter
		 * @extends Backbone.RelationalModel
		 */
		var ObjectFilter = Backbone.RelationalModel.extend({
			idAttribute: &#x27;_id&#x27;,

			isEmpty: function () {
				if (this.get(&#x27;subClass&#x27;) == &quot;NoteFilter&quot;) { // NoteFilter
					if (this.get(&#x27;text&#x27;) !== &#x27;&#x27; || this.get(&#x27;tasks&#x27;).length !== 0 || this.get(&#x27;tags&#x27;).length !== 0) { return false; }
				} else {
					if (this.get(&#x27;subClass&#x27;) == &quot;TagFilter&quot;) { // TagFilter
						if (this.get(&#x27;text&#x27;) !== &#x27;&#x27;) { return false; }
					} else { // TaskFilter
						if (this.get(&#x27;text&#x27;) !== &#x27;&#x27; || this.get(&#x27;tags&#x27;).length !== 0) { return false; }
					}
				}
				return true;
			},

			isSimilar: function (of) {
				if(this.get(&quot;text&quot;) != of.get(&quot;text&quot;)) { return false; }
				
				if (this.get(&#x27;subClass&#x27;) == &quot;NoteFilter&quot;) { // NoteFilter
					var tagsLargest   = this;
					var tagsShortest  = of;
					var tasksLargest  = this;
					var tasksShortest = of;
					if (this.get(&#x27;tags&#x27;).length &lt; of.get(&#x27;tags&#x27;).length) {
						tagsLargest  = of;
						tagsShortest = this;
					}
					if (this.get(&#x27;tasks&#x27;).length &lt; of.get(&#x27;tasks&#x27;).length) {
						tasksLargest  = of;
						tasksShortest = this;
					}

					// Trying to find one criteria that is not in common. 
					// _.find() should then be different from undefined and the test should return false (the filters are not equal)
					return (undefined === tagsLargest.get(&#x27;tags&#x27;).find(function(tag) {
						return (false === tagsShortest.get(&#x27;tags&#x27;).contains(tag));
					})) &amp;&amp; (undefined === tasksLargest.get(&#x27;tasks&#x27;).find(function(task) {
						return (false === tasksShortest.get(&#x27;tasks&#x27;).contains(task));
					}));
				} else {
					if (this.get(&#x27;subClass&#x27;) == &quot;TaskFilter&quot;) { // TaskFilter
						var tagsLargest  = this;
						var tagsShortest = of;
						if (this.get(&#x27;tags&#x27;).length &lt; of.get(&#x27;tags&#x27;).length) {
							tagsLargest  = of;
							tagsShortest = this;
						}
						// Trying to find one criteria that is not in common. 
						// _.find() should then be different from undefined and the test should return false (the filters are not equal)
						return (undefined === tagsLargest.get(&#x27;tags&#x27;).find(function(tag) {
							return (false === tagsShortest.get(&#x27;tags&#x27;).contains(tag));
						}));
					}
				}

				return true;
			},

			superClone: function () {
				var superClone = this.clone();
				if (this.get(&#x27;subClass&#x27;) == &quot;NoteFilter&quot;) { // NoteFilter
					superClone.get(&#x27;tags&#x27;).add(this.get(&#x27;tags&#x27;).models);
					superClone.get(&#x27;tasks&#x27;).add(this.get(&#x27;tasks&#x27;).models);
				} else {
					if (this.get(&#x27;subClass&#x27;) == &quot;TaskFilter&quot;) { // TaskFilter
						superClone.get(&#x27;tags&#x27;).add(this.get(&#x27;tags&#x27;).models);
					}
				}
				return superClone;
			},

			makeItMatch: function (of) {
				this.set(&quot;text&quot;, of.get(&quot;text&quot;));

				if (this.get(&#x27;subClass&#x27;) == &quot;NoteFilter&quot;) { // NoteFilter
					this.get(&#x27;tags&#x27;).remove(this.get(&#x27;tags&#x27;).models);
					this.get(&#x27;tags&#x27;).add(of.get(&#x27;tags&#x27;).models);
					this.get(&#x27;tasks&#x27;).add(of.get(&#x27;tasks&#x27;).models);
					this.get(&#x27;tasks&#x27;).remove(this.get(&#x27;tasks&#x27;).models);
				} else {
					if (this.get(&#x27;subClass&#x27;) == &quot;TaskFilter&quot;) { // TaskFilter
						this.get(&#x27;tags&#x27;).remove(this.get(&#x27;tags&#x27;).models);
						this.get(&#x27;tags&#x27;).add(of.get(&#x27;tags&#x27;).models);
					}
				}
			},

			defaults: function() {
				return {
					subClass  : &#x27;NoteFilter&#x27;,
					label     : &#x27;New filter&#x27;,
					text      : &#x27;&#x27;
				};
			}
		});

		/**
		 * Used to filter collections of {{#crossLink &quot;Tag&quot;}}{{/crossLink}}s.
		 * 
		 * @class TagFilter
		 * @extends ObjectFilter
		 */
		var TagFilter = ObjectFilter.extend({
			defaults: function() {
				return {
					subClass  : &#x27;TagFilter&#x27;,
					label     : &#x27;New filter&#x27;,
					text      : &#x27;&#x27;,
					created_at: new Date(),
					updated_at: new Date()
				};
			}
		});

		/**
		 * Used to filter collections of {{#crossLink &quot;Task&quot;}}{{/crossLink}}s.
		 * 
		 * @class TaskFilter
		 * @extends ObjectFilter
		 */
		var TaskFilter = ObjectFilter.extend({
			relations: [{
				type: &#x27;HasMany&#x27;,
				key: &#x27;tags&#x27;,
				relatedModel: Tag
			}],
			defaults: function() {
				return {
					subClass  : &#x27;TaskFilter&#x27;,
					label     : &#x27;New filter&#x27;,
					text      : &#x27;&#x27;,
					completed : 0,
					created_at: new Date(),
					updated_at: new Date()
				};
			}
		});

		/**
		 * Used to filter collections of {{#crossLink &quot;Note&quot;}}{{/crossLink}}s.
		 * 
		 * @class NoteFilter
		 * @extends ObjectFilter
		 */
		var NoteFilter = ObjectFilter.extend({
			relations: [{
				type: &#x27;HasMany&#x27;,
				key: &#x27;tags&#x27;,
				relatedModel: Tag,
				includeInJSON: &#x27;_id&#x27;,
			},
			{
				type: &#x27;HasMany&#x27;,
				key: &#x27;tasks&#x27;,
				relatedModel: Task,
				includeInJSON: &#x27;_id&#x27;,
			}],
			defaults: function() {
				return {
					subClass  : &#x27;NoteFilter&#x27;,
					label     : &#x27;New filter&#x27;,
					text      : &#x27;&#x27;,
					created_at: new Date(),
					updated_at: new Date()
				};
			}
		});

		return {
			Note: NoteFilter,
			Task: TaskFilter,
			Tag : TagFilter,
		};
	}
);
    </pre>
</div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script src="../assets/vendor/prettify/prettify-min.js"></script>
<script>prettyPrint();</script>
<script src="../assets/js/yui-prettify.js"></script>
<script src="../assets/../api.js"></script>
<script src="../assets/js/api-filter.js"></script>
<script src="../assets/js/api-list.js"></script>
<script src="../assets/js/api-search.js"></script>
<script src="../assets/js/apidocs.js"></script>
</body>
</html>
